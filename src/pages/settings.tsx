

import React from "react";
import { type NextPage } from "next";
import Head from "next/head";
import ToggleSwitch from '../components/settingspage/toggle-switch';
import BackArrowButton from '../components/settingspage/back-arrow-button';

const useLocalStorageToggle = (key: string, initial: boolean) => {
  const [value, setValue] = React.useState(() => {
    if (typeof window === 'undefined') return initial;
    const stored = window.localStorage.getItem(key);
    return stored !== null ? stored === 'true' : initial;
  });
  const setAndStore = (val: boolean) => {
    setValue(val);
    if (typeof window !== 'undefined') {
      window.localStorage.setItem(key, val.toString());
    }
  };
  return [value, setAndStore] as const;
};

const Settings: NextPage = () => {
  const [notificationEnabled, setNotificationEnabled] = useLocalStorageToggle('notificationEnabled', false);
  const [autoLocationEnabled, setAutoLocationEnabled] = useLocalStorageToggle('autoLocationEnabled', false);
  const [themeEnabled, setThemeEnabled] = useLocalStorageToggle('themeEnabled', false);

  return <>
    <Head>
      <title>Settings</title>
      <meta name="description" content="Generated by create-t3-app" />
      <link rel="icon" href="/favicon.ico" />
    </Head>

    <div className="settings-container mx-auto flex flex-col items-center justify-center">
      <div className="settings-column flex flex-col gap-6 w-full mx-auto" style={{ width: '100dvh', height: '100vh' }}>
        <div className="w-full flex flex-row items-center justify-between py-4 border-b gap-4">
          <span className="text-xl font-medium">Notifications</span>
          <div className="flex items-center">
            <ToggleSwitch checked={notificationEnabled} onChange={setNotificationEnabled} id="notification-toggle" />
          </div>
        </div>
        <div className="w-full flex flex-row items-center justify-between py-4 border-b gap-4">
          <span className="text-xl font-medium">Auto location</span>
          <div className="flex items-center">
            <ToggleSwitch checked={autoLocationEnabled} onChange={setAutoLocationEnabled} id="auto-location-toggle" />
          </div>
        </div>
        <div className="w-full flex flex-row items-center justify-between py-4 border-b gap-4">
          <span className="text-xl font-medium">Theme</span>
          <div className="flex items-center">
            <ToggleSwitch checked={themeEnabled} onChange={setThemeEnabled} id="theme-toggle" />
          </div>
        </div>
        <div className="w-full flex items-center justify-center py-4">
          <BackArrowButton />
        </div>
      </div>
    </div>
  </>;
};

export default Settings;